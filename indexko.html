<html>
	<head>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js"></script>
		<script src="js/knockout.2.0.0.js"></script> 
		<script src="js/sammy.js"></script> 
		
		<link rel="stylesheet" type="text/css" href="css/main.css" />
		<link rel="stylesheet" type="text/css" href="css/nav.css"/> 
	</head>
<body>

	
	<!-- Menu -->
	<ul class="menu" data-bind="foreach: menuItems">
    	<li data-bind="text: $data,
                   css: { selected: $data == $root.selectedMenuItem() },
                   click: $root.goToScreen"></li>
	</ul>
	
	
	<div data-bind="template: { name: templateToUse, foreach: selectedMenuData }"></div>
	
	<script id="Teams" type="text/html">
    	<div data-bind="text: name"></div>    
	</script>
	
	<script id="Players" type="text/html">
    	<div data-bind="text: firstName"></div>    
	</script>
	
	<script id="Conferences" type="text/html">
    	<div data-bind="text: name"></div>    
	</script>
	
	<script type="text/javascript">
	//var menuItem = function (id, data) {
//		this.id = ko.observable(id); 
//		this.data = ko.observable(data); 
//	}
	
	function FBViewModel () {
		//Data
		var self = this; 
		//self.menuItems = [new menuItem('Teams','teams.json'), new menuItem('Players','players.json'), new menuItem('Conferences','conferences.json')];
		self.menuItems = ['Teams','Players','Conferences'];
		self.selectedMenuItem = ko.observable(); 
		self.selectedMenuData = ko.observableArray(); 
		self.selectedView = ko.observable("home");
		
		//Behaviors
		//hide other templates?
		self.goToScreen = function (menuItem) { 	location.hash = menuItem; }; 
		
		//template switching
	    self.templateToUse = function(item) {
    	    	return item === self.selectedMenuItem() ? 'home' : self.selectedMenuItem();
    		}.bind(FBViewModel);

		// Client-side routes
		Sammy(function (context) {
			this.get('#:menuItem', function () {
				self.selectedMenuItem(this.params.menuItem);
				//get file name
				var dataFile = self.selectedMenuItem().toLowerCase() + '.json';  
				console.log(dataFile); 
				//set the view 
				self.selectedView= self.selectedMenuItem().toLowerCase() ; 
				
				self.selectedMenuData(null);
				$.ajax({
          				url: 'data/' + dataFile,
          				dataType: 'json',
          				success: function(items) {
							self.selectedMenuData(items); 
							//var viewModel = ko.mapping.fromJS(data); ??
            				//$.each(items, function(i, item) {
              				//	console.log(item.firstName, '-', item.team);

            			//});
         			 }
        		});
				//$.get("/mail", { folder: this.params.folder }, self.selectedFolderData);
			});
			
			this.get('#:menuItem/:itemId', function () {
				self.selectedMenuItem(this.params.menuItem);
				self.selectedMenuData(null);
				//$.get("/mail", { mailId: this.params.mailId }, self.selectedMailData);
			});

			this.get('', function () { this.app.runRoute('get', '#Inbox') });
			
		}).run(); 
		
	}
	ko.applyBindings(new FBViewModel); 
	
	
	function GetData(menuItem)
	{
		switch (menuItem)
		{
			case "Teams" : 
				//do stuff
				break; 
				
			case "Players" : 
				//do stuff
				break; 

			case "Conferences" : 
				//do stuff
				break; 

		}
	}
	</script> 	

	<hr />
	<h2>Debug</h2>
	<div data-bind="text: ko.toJSON(FBViewModel)"></div>
	
	

</body>
</html>